# ------------------------------------------------------------------
#
#   Thex System Server - Thex 1223
#
#   Copyrigth 2023 | Kaina H. & Thex 1223
#
#   Thex 1223: https://github.com/Thex1223/
#   Kainan H.: https://github.com/Na18k
#
#   Version: v0.0.1-beta
#   License: MIT License
#
#   Team:
#       Kainan H. [GitHub: Na18k]
#
# ------------------------------------------------------------------


# ------------------------------------------------------------------
# $$$$$$\                                              $$\
# \_$$  _|                                             $$ |
#   $$ |  $$$$$$\$$$$\   $$$$$$\   $$$$$$\   $$$$$$\ $$$$$$\
#   $$ |  $$  _$$  _$$\ $$  __$$\ $$  __$$\ $$  __$$\\_$$  _|
#   $$ |  $$ / $$ / $$ |$$ /  $$ |$$ /  $$ |$$ |  \__| $$ |
#   $$ |  $$ | $$ | $$ |$$ |  $$ |$$ |  $$ |$$ |       $$ |$$\
# $$$$$$\ $$ | $$ | $$ |$$$$$$$  |\$$$$$$  |$$ |       \$$$$  |
# \______|\__| \__| \__|$$  ____/  \______/ \__|        \____/
#                       $$ |
#                       $$ |
#                       \__|
# ------------------------------------------------------------------
import os
import json
import socket


# ------------------------------------------------------------------
# $$$$$$$$\                              $$\     $$\
# $$  _____|                             $$ |    \__|
# $$ |   $$\   $$\ $$$$$$$\   $$$$$$$\ $$$$$$\   $$\  $$$$$$\  $$$$$$$\   $$$$$$$\
# $$$$$\ $$ |  $$ |$$  __$$\ $$  _____|\_$$  _|  $$ |$$  __$$\ $$  __$$\ $$  _____|
# $$  __|$$ |  $$ |$$ |  $$ |$$ /        $$ |    $$ |$$ /  $$ |$$ |  $$ |\$$$$$$\
# $$ |   $$ |  $$ |$$ |  $$ |$$ |        $$ |$$\ $$ |$$ |  $$ |$$ |  $$ | \____$$\
# $$ |   \$$$$$$  |$$ |  $$ |\$$$$$$$\   \$$$$  |$$ |\$$$$$$  |$$ |  $$ |$$$$$$$  |
# \__|    \______/ \__|  \__| \_______|   \____/ \__| \______/ \__|  \__|\_______/
# ------------------------------------------------------------------
def log(msg):
    print(msg)

def json_data():
    with open("data.json", "r", encoding="utf8") as arquivo:
        arquivo_saida = json.load(arquivo)

    return arquivo_saida

def execute_host(ip="", porta=8000, path="./"):
    data_app = json_data()
    SERVER_IP = socket.gethostbyname(socket.gethostname())
    log("-------------------------------")
    log("")
    log(f'   {data_app["msg"]["1"]}')
    log("")
    log("-------------------------------")
    if ip == "":
        print(f'IP ==> {SERVER_IP}')
        os.system(f"py -m http.server {porta} -d {path}")

    elif ip != "":
        os.system(f"py -m http.server --bind {ip} {porta} -d {path}")


# ------------------------------------------------------------------
#  $$$$$$\                        $$\
# $$  __$$\                       $$ |
# $$ /  \__|$$\   $$\  $$$$$$$\ $$$$$$\    $$$$$$\  $$$$$$\$$$$\
# \$$$$$$\  $$ |  $$ |$$  _____|\_$$  _|  $$  __$$\ $$  _$$  _$$\
#  \____$$\ $$ |  $$ |\$$$$$$\    $$ |    $$$$$$$$ |$$ / $$ / $$ |
# $$\   $$ |$$ |  $$ | \____$$\   $$ |$$\ $$   ____|$$ | $$ | $$ |
# \$$$$$$  |\$$$$$$$ |$$$$$$$  |  \$$$$  |\$$$$$$$\ $$ | $$ | $$ |
#  \______/  \____$$ |\_______/    \____/  \_______|\__| \__| \__|
#           $$\   $$ |
#           \$$$$$$  |
#            \______/
# ------------------------------------------------------------------

log("")
log("  ::::::::::: :::    ::: :::::::::: :::    ::: ")
log("     :+:     :+:    :+: :+:        :+:    :+:  ")
log("    +:+     +:+    +:+ +:+         +:+  +:+    ")
log("   +#+     +#++:++#++ +#++:++#     +#++:+      ")
log("  +#+     +#+    +#+ +#+         +#+  +#+      ")
log(" #+#     #+#    #+# #+#        #+#    #+#   ")
log("###     ###    ### ########## ###    ###      ")
log("")
log("      ::::::::  :::::::::: :::::::::  :::     ::: :::::::::: ::::::::: ")
log("    :+:    :+: :+:        :+:    :+: :+:     :+: :+:        :+:    :+: ")
log("   +:+        +:+        +:+    +:+ +:+     +:+ +:+        +:+    +:+  ")
log("  +#++:++#++ +#++:++#   +#++:++#:  +#+     +:+ +#++:++#   +#++:++#:    ")
log("        +#+ +#+        +#+    +#+  +#+   +#+  +#+        +#+    +#+    ")
log("#+#    #+# #+#        #+#    #+#   #+#+#+#   #+#        #+#    #+#     ")
log("########  ########## ###    ###     ###     ########## ###    ###   ")

while True:
    data_app = json_data()
    ent_IP = data_app["ip"]
    ent_PORT = data_app["port"]
    ent_diretory = data_app["diretory"]

    if data_app["config"] == True:
        log("----------------------")
        log(f'{data_app["msg"]["2"]}')
        log("")
        log(f'{data_app["msg"]["3"]}')
        log("----------------------")
        try:
            execute_host(ent_IP, int(ent_PORT), ent_diretory)
        except ValueError:
            log("----------------------")
            log("")
            log(f'{data_app["msg"]["4"]}')
            log("")
            log("----------------------")
            continue

    elif data_app["config"] == False:
        SERVER_IP = socket.gethostbyname(socket.gethostname())
        PORTA_PADRAO = 25565
        log("----------------------")
        log(f'{data_app["msg"]["5"]}')
        log("----------------------")
        log("")
        log(f"IP ==> {SERVER_IP}")
        log(f"PORT ==> {PORTA_PADRAO}")

        try:
            execute_host(porta=PORTA_PADRAO)
        except ValueError:
            log("----------------------")
            log("")
            log(f'{data_app["msg"]["6"]}')
            log("")
            log("----------------------")
            continue
